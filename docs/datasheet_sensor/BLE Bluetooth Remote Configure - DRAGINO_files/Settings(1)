var XWiki=function(f){f.AnnotationSettings=Class.create({initialize:function(){this.addCheckboxListeners();this.addClearListeners();this.addToggleFilterVisibility(".criterion-label",".criterion","collapsed");this.addToggleFilterVisibility(".annotation-filters-toggler a",".annotation-filters","collapsed");document.fire("xwiki:annotations:filter:changed",this.getCurrentFilter())},addCheckboxListeners:function(){$$(".criteria input[type\x3dcheckbox]").each(function(c){c.observe("click",function(a){var b=
this.getCurrentFilter();document.fire("xwiki:annotations:filter:changed",b);a=a.element();a.up().toggleClassName("selected");a=a.up(".criterion");a.select("label.selected").length?a.addClassName("active"):a.removeClassName("active")}.bindAsEventListener(this))},this)},addClearListeners:function(){$$(".criterion .clear").each(function(c){c.observe("click",function(a){a.stop();a=a.element().up(".criterion");a.select("label.selected").each(function(b){b.removeClassName("selected");b.down("input").checked=
!1});a.removeClassName("active");a=this.getCurrentFilter();document.fire("xwiki:annotations:filter:changed",a)}.bindAsEventListener(this))},this)},getCurrentFilter:function(){var c=[];$$(".criteria .criterion").each(function(a){var b=a.down("input[type\x3dhidden]");if(b){b=b.name;var e=[];a.select("input[type\x3dcheckbox]").each(function(d){d.checked&&e.push(d.value)});for(a=0;a<e.length;a++)c.push({name:b,value:e[a]})}});return c},addToggleFilterVisibility:function(c,a,b){$$(c).each(function(e){e.observe("click",
function(d){d.stop();(d=d.element().up(a))&&d.toggleClassName(b)})})}});return f}(XWiki||{});document.observe("xwiki:annotations:settings:loaded",function(){new XWiki.AnnotationSettings});